%Zhaoyi Jiang(.1364) ME Student
%MWF 9:10-10:05
%ME 2850
%HW6

clc
clear
fprintf('Zhaoyi Jiang(.1364)\n')
fprintf('MWF 9:10-10:05')
fprintf('ME 2850\n')
fprintf('HW6\n')


%Chapter 3 P16
fprintf('----------------------4.22---------------------\n')
a1=[2 1 4 -2
    -3 4 2 -1
    3 5 -2 1
    -2 3 2 4];
b1=[19;1;8;13];
x1=GaussJordan(a1,b1)

a2=[1 2 3 4 5 6
    1 -3 2 5 -4 6
    6 1 -2 4 3 5
    3 2 -1 4 5 6
    4 -2 -1 3 6 5
    5 -6 -3 4 -2 1];
b2=[91;37;63;81;69;-4];
x2=GaussJordan(a2,b2)


%Chapter 3 P16
fprintf('----------------------4.32---------------------\n')
a=[0.707  1 0 0 0 0 0 0 0 0 0 0 0;
   -0.7071 0 1 0 0 0 0 0 0 0 0 0 0;
   0.707  0 0 1 0 0 0 0 0 0 0 0 0;
   0 -1 0 0 0.659 1 0 0 0 0 0 0 0;
   0 0 0 -1 -0.753 0 0 0 0 0 0 0 0;
   0 0 -1 0 -0.659 0 1 0 0 0 0 0 0;
   0 0 0 0 0.753 0 0 1 0 0 0 0 0;
   0 0 0 0 0 -1 0 0 0.659 1 0 0 0;
   0 0 0 0 0 0 0 -1 -0.753 0 0 0 0 ;
   0 0 0 0 0 0 -1 0 -0.659 0 1 0 0;
   0 0 0 0 0 0 0 0 0.753 0 0 1 0;
   0 0 0 0 0 0 0 0 0 -1 0 0 0.707;
   0 0 0 0 0 0 0 0 0 0 0 -1 -0.707];
b=[0;2000;-6229;0;600;0;0;0;800;0;2429;0;600];
ansa=GaussJordan(a,b)

ansc=a\b


%Chapter 3 P16
fprintf('----------------------4.38---------------------\n')
a=[0.2  0.2  0.2  0.2  0.2;
   0.35 0.15 0.35  0   0.15;
   0.1  0.3  0.1  0.1  0.4;
    0   0.3  0.1  0.4  0.2;
   0.15 0.3  0.2  0.35  0];
b=[1.44;1.16;1.38;1.78;1.61];
x=GaussJordan(a,b)
xbulidin=rref([a,b])


%Chapter 3 P16
fprintf('----------------------4.39---------------------\n')
a=[9.5 -2.5 0 -2 0
   -2.5 11 -3.5 0 -5
   0 -3.5 15.5 0 -4
   -2 0 0 7 -3
   0 -5 -4 -3 12];
b=[12;-16;14;10;-30];
xbulidin=rref([a,b])

k=1;x1=0;x2=0;x3=0;x4=0;x5=0;
disp('k       x1        x2        x3        x4        x5')
disp('1       0         0         0         0         0')
for k=2:100
    x11=x1;x22=x2;x33=x3;x44=x4;x55=x5;
    x1=(12+2.5*x2+2*x4)/9.5;
    x2=(-16+5*x5+3.5*x3+2.5*x1)/11;
    x3=(14+4*x5+3.5*x2)/15.5;
    x4=(10+3*x5+2*x1)/7;
    x5=(-30+5*x2+4*x3+3*x4)/12;
    fprintf('%2.0f %8.5f  %8.5f  %8.5f  %8.5f  %8.5f\n',k,x1,x2,x3,x4,x5)
    if ((x1-x11)/x11<0.0001 && (x2-x22)/x22<0.0001 && (x3-x33)/x33<0.0001 && (x4-x44)/x44<0.0001 &&(x5-x55)/x55<0.0001 )
        break
    end
end







